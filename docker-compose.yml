version: '3.8'

services:
  # The Database Container
  nexus-sqldb:
    image: mcr.microsoft.com/mssql/server:2019-latest # Stable build for compatibility
    container_name: nexus-sqldb # CRITICAL: This is the HOSTNAME for your C# connection string
    hostname: nexus-sqldb
    environment:
      # Mandatory SQL Server Config
      SA_PASSWORD: "YourSecurePassword123" # Must be strong (min 8 chars, complex)
      ACCEPT_EULA: "Y"
    ports:
      - "1433:1433" # Expose to host machine (optional, but good for local testing)
    volumes:
      - sql_data:/var/opt/mssql # Persistent data storage
    networks:
      - nexus-network

  # The Database Management GUI
  adminer: # A lightweight SQL management tool, replacing pgAdmin for simplicity
    image: adminer:latest
    container_name: nexus_adminer
    ports:
      - "8080:8080" # Access via http://localhost:8080
    environment:
      ADMINER_DEFAULT_SERVER: nexus-sqldb # Connects directly to the DB container name
    depends_on:
      - nexus-sqldb
    networks:
      - nexus-network

volumes:
  sql_data:
    driver: local

networks:
  nexus-network:
    driver: bridge